<!DOCTYPE html>
<html>
<head>
    <title>login</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <link href="resources/css/jquery-ui-themes.css" type="text/css" rel="stylesheet"/>
    <link href="resources/css/axure_rp_page.css" type="text/css" rel="stylesheet"/>
    <link href="data/styles.css" type="text/css" rel="stylesheet"/>
    <link href="files/login/styles.css" type="text/css" rel="stylesheet"/>
    <script src="resources/scripts/jquery-1.7.1.min.js"></script>
    <script src="resources/scripts/jquery-ui-1.8.10.custom.min.js"></script>
    <script src="resources/scripts/prototypePre.js"></script>
    <script src="javascripts/convertFile.js"></script>
    <script src="data/document.js"></script>
    <script src="resources/scripts/prototypePost.js"></script>
    <script src="files/login/data.js"></script>
    <script type="text/javascript">
        $axure.utils.getTransparentGifPath = function() { return 'resources/images/transparent.gif'; };
        $axure.utils.getOtherPath = function() { return 'resources/Other.html'; };
        $axure.utils.getReloadPath = function() { return 'resources/reload.html'; };
    </script>
    <script src="javascripts/require.js"></script>
    <script src="javascripts/sha512.js"></script>
</head>
<body>
<div id="base" class="">

    <!-- SlidePanel (动态面板) -->
    <div id="u0" class="ax_default" data-label="SlidePanel">
        <div id="u0_state0" class="panel_state" data-label="State1" style="">
            <div id="u0_state0_content" class="panel_state_content">

                <!-- Unnamed (图片) -->
                <div id="u1" class="ax_default image">
                    <img id="u1_img" class="img " src="images/login/u1.jpg"/>
                    <!-- Unnamed () -->
                    <div id="u2" class="text" style="display:none; visibility: hidden">
                        <p><span></span></p>
                    </div>
                </div>
            </div>
        </div>
        <div id="u0_state1" class="panel_state" data-label="State2" style="visibility: hidden;">
            <div id="u0_state1_content" class="panel_state_content">

                <!-- Unnamed (图片) -->
                <div id="u3" class="ax_default image">
                    <img id="u3_img" class="img " src="images/login/u3.jpg"/>
                    <!-- Unnamed () -->
                    <div id="u4" class="text" style="display:none; visibility: hidden">
                        <p><span></span></p>
                    </div>
                </div>
            </div>
        </div>
        <div id="u0_state2" class="panel_state" data-label="State3" style="visibility: hidden;">
            <div id="u0_state2_content" class="panel_state_content">

                <!-- Unnamed (图片) -->
                <div id="u5" class="ax_default image">
                    <img id="u5_img" class="img " src="images/login/u5.jpeg"/>
                    <!-- Unnamed () -->
                    <div id="u6" class="text" style="display:none; visibility: hidden">
                        <p><span></span></p>
                    </div>
                </div>
            </div>
        </div>
        <div id="u0_state3" class="panel_state" data-label="State4" style="visibility: hidden;">
            <div id="u0_state3_content" class="panel_state_content">

                <!-- Unnamed (图片) -->
                <div id="u7" class="ax_default image">
                    <img id="u7_img" class="img " src="images/login/u7.jpeg"/>
                    <!-- Unnamed () -->
                    <div id="u8" class="text" style="display:none; visibility: hidden">
                        <p><span></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- tag1 (椭圆形) -->
    <div id="u9" class="ax_default ellipse" data-label="tag1" selectiongroup="Tag">
        <img id="u9_img" class="img " src="images/login/tag1_u9.png"/>
        <!-- Unnamed () -->
        <div id="u10" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- tag2 (椭圆形) -->
    <div id="u11" class="ax_default ellipse" data-label="tag2" selectiongroup="Tag">
        <img id="u11_img" class="img " src="images/login/tag1_u9.png"/>
        <!-- Unnamed () -->
        <div id="u12" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- tag3 (椭圆形) -->
    <div id="u13" class="ax_default ellipse" data-label="tag3" selectiongroup="Tag">
        <img id="u13_img" class="img " src="images/login/tag1_u9.png"/>
        <!-- Unnamed () -->
        <div id="u14" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- tag4 (椭圆形) -->
    <div id="u15" class="ax_default ellipse" data-label="tag4" selectiongroup="Tag">
        <img id="u15_img" class="img " src="images/login/tag1_u9.png"/>
        <!-- Unnamed () -->
        <div id="u16" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u17" class="ax_default box_1">
        <img id="u17_img" class="img " src="images/login/u17.png"/>
        <!-- Unnamed () -->
        <div id="u18" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u19" class="ax_default label">
        <div id="u19_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u20" class="text">
            <p><span>账号密码登录</span></p>
        </div>
    </div>

    <!-- Unnamed (文本框) -->
    <div id="u21" class="ax_default text_field">
        <input id="u21_input" type="text" placeholder="&nbsp;密码"/>
    </div>

    <!-- Unnamed (文本框) -->
    <div id="u22" class="ax_default text_field">
        <input id="u22_input" type="text" placeholder="&nbsp;手机号/用户名"/>
    </div>

    <!-- Unnamed (单选按钮) -->
    <div id="u23" class="ax_default radio_button">
        <label for="u23_input">
            <!-- Unnamed () -->
            <div id="u24" class="text" >
                <p><span>下次自动登录</span></p>
            </div>
        </label>
        <input id="u23_input" type="radio" value="radio" name="u23" />
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u25" onclick="login()"  class="ax_default button">
        <div id="u25_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u26" class="text" div style="cursor:pointer;">
            <p><span>登录</span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u27" class="ax_default label">
        <div id="u27_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u28" class="text">
            <p><span>忘记密码？</span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u29" class="ax_default box_2">
        <div id="u29_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u30" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u31" class="ax_default label">
        <div id="u31_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u32" class="text">
            <p><span>第三方登录</span></p>
        </div>
    </div>

    <!-- Unnamed (图片) -->
    <div id="u33" class="ax_default image">
        <img id="u33_img" class="img " src="images/login/u33.png"/>
        <!-- Unnamed () -->
        <div id="u34" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (图片) -->
    <div id="u35" class="ax_default image">
        <img id="u35_img" class="img " src="images/login/u35.png"/>
        <!-- Unnamed () -->
        <div id="u36" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (图片) -->
    <div id="u37" class="ax_default image">
        <img id="u37_img" class="img " src="images/login/u37.jpg"/>
        <!-- Unnamed () -->
        <div id="u38" class="text" style="display:none; visibility: hidden">
            <p><span></span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u39" onclick="transToRegister()" class ="ax_default button">
        <div id="u39_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u40" class="text" div style="cursor:pointer;">

            <p><span>立即注册</span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u41" class="ax_default button">
        <img id="u41_img" class="img " src="images/login/u41.png"/>
        <!-- Unnamed () -->
        <div id="u42" class="text">
            <p><span>会员中心</span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u43" class="ax_default label">
        <div id="u43_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u44" class="text">
            <p><span>问题反馈</span></p>
        </div>
    </div>

    <!-- Unnamed (矩形) -->
    <div id="u45" class="ax_default label">
        <div id="u45_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u46" class="text">
            <p><span>E-sub</span></p>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    function login() {
        var account = document.getElementById("u22_input").value;
        var password = document.getElementById("u21_input").value;

       // console.log("Encryption begin");
        require(['sha512'] ,function(SHA512,callback){
            var hash = sha512.create();
            hash.update(password);
         var   password_secrt= hash.hex();
            console.log(password_secrt);
            return;
        });


        console.log(account+":"+password);

        var transToBack={"Account":account,"Password":password};
        $.ajax({
            url:"/login/test",
            type:"POST",
            dataType:"JSON",
            data:transToBack,
            success: function(data,textStatus){


                window.location.href='/index';
                console.log("ok");


            },
            error: function(data){

                var respond_json=JSON.parse(data.responseText);

                console.log(respond_json.error);


                if(respond_json.error=='password wrong') {

                    console.log("密码错误");

                    console.log(data);

                    alert("password WRONG! please try again");

                    window.location.href = "/login";



                }
                else if(respond_json.error=='NO account'){

                    console.log("账户不存在");

                    alert("Account don't exist");

                    window.location.href = "/register";


                }

            },

            success: function(data){
                setCookie("user",account);

                console.log("密码正确");

                console.log(data);

                alert("Welcome");

                window.location.href="/index";



            },
            statusCode:{
                200:function () {
                    window.location.href='/index';
                },
                404:function(){
                    window.location.href='/error';
                }
            }
        });
        console.log(transToBack);
        //window.location.href='http://localhost:3000';
    }

    function transToRegister() {
        window.location.href='/register';
    }

    function setCookie(name,value)
    {
        /*
        *--------------- setCookie(name,value) -----------------
        * setCookie(name,value)
        * 功能:设置得变量name的值
        * 参数:name,字符串;value,字符串.
        * 实例:setCookie('username','baobao')
        *--------------- setCookie(name,value) -----------------
        */
        var Days = 30; //此 cookie 将被保存 30 天
        var exp　= new Date();
        exp.setTime(exp.getTime() + Days*24*60*60*1000);
        document.cookie = name + "="+ escape (value) + ";expires=" + exp.toGMTString();
        location.href = "/index"; //接收页面.
    }


</script>
</html>
